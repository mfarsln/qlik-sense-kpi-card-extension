/* KPI Card Extension Styles - Optimized */

/* Base card styles */
.kpi-card {
	width: 100%;
	height: 100%;
	color: inherit;
	/* Allow border to be set by inline styles */
	border-style: solid !important;
	outline: none !important;
	box-sizing: border-box;
}

/* Override Qlik theme borders - consolidated selectors */
/* Exclude the main card container from forced no-border to allow layout settings */
.kpi-card *:not(.kpi-card--selected),
.qv-object.kpi-card:not(.kpi-card--selected) *,
.qv-object .kpi-card:not(.kpi-card--selected) * {
	border: none !important;
	outline: none !important;
	box-shadow: none !important;
}

/* Specific Qlik object overrides */
.qv-object[data-qv-object="kpi-card"],
.qv-object[data-qv-object="kpi-card"] *,
.qv-object[data-qv-object="kpi-card"] .qv-object-content,
.qv-object[data-qv-object="kpi-card"] .qv-object-body,
.lv-object[data-qv-object="kpi-card"],
.lv-object[data-qv-object="kpi-card"] *,
.lv-object[data-qv-object="kpi-card"] .lv-object-content {
	background: transparent !important;
}

/* Card sections */
.kpi-card__kpi-section {
	display: flex;
	flex-direction: column;
	justify-content: center;
	position: relative;
}

.kpi-card__trend-section {
	display: flex;
	flex-direction: column;
	justify-content: flex-end;
	position: relative;
}

/* Title styles */
.kpi-card__title {
	opacity: 0.8;
}

/* Value styles */
.kpi-card__value {
	font-weight: 600;
	line-height: 1.2;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	transition: transform 0.3s ease, opacity 0.3s ease;
	font-size: inherit;
}

.kpi-card__value:hover {
	transform: scale(1.05);
}

/* Sparkline styles */
.kpi-card__sparkline {
	height: 100%;
	width: 100%;
	min-height: 120px;
}

.kpi-card__sparkline-inner {
	width: 100%;
	height: 100%;
	color: currentColor;
}

.kpi-card__sparkline-inner svg path {
	transition: stroke-width 0.2s ease;
}

.kpi-card__sparkline:hover .kpi-card__sparkline-inner svg path {
	transition: stroke-width 0.2s ease;
}

/* Labels */
.kpi-card__labels {
	display: flex;
	justify-content: space-between;
	opacity: 0.8;
	font-size: inherit;
}

/* Empty state */
.kpi-card--empty {
	display: flex;
	align-items: center;
	justify-content: center;
	height: 100%;
	opacity: 0.7;
	font-size: calc(0.8vw + 0.5vh + 8px);
	padding: calc(0.5vw + 0.5vh + 4px);
	text-align: center;
}

/* Pulse animation for min/max markers */
.kpi-pulse {
	animation: kpi-pulse 1.6s infinite ease-in-out;
}

@keyframes kpi-pulse {
	0% { opacity: 0.9; }
	50% { opacity: 0.35; }
	100% { opacity: 0.9; }
}

/* Legacy pulse animation for backward compatibility */
.kpi-card__pulse-point {
	animation: pulse 2s infinite;
	stroke: white;
	stroke-width: 0.5;
}

@keyframes pulse {
	0% { transform: scale(1); opacity: 1; }
	50% { transform: scale(1.3); opacity: 0.8; }
	100% { transform: scale(1); opacity: 1; }
}

/* Counter animation */
@keyframes counterAppear {
	0% { 
		opacity: 0; 
		transform: scale(0.8) translateY(10px); 
	}
	100% { 
		opacity: 1; 
		transform: scale(1) translateY(0); 
	}
}

.kpi-card__value--animating {
	animation: counterAppear 0.6s ease-out forwards;
}

/* Delta animation */
.kpi-card__delta {
	transition: opacity 0.6s ease, transform 0.6s ease;
}

.kpi-card__delta--animating {
	animation: deltaSlideIn 0.6s ease-out forwards;
}

@keyframes deltaSlideIn {
	0% { 
		opacity: 0; 
		transform: translateX(-10px); 
	}
	100% { 
		opacity: 1; 
		transform: translateX(0); 
	}
}

/* Quick buttons */
.kpi-card__quick-buttons {
	opacity: 0.8;
	transition: opacity 0.2s ease;
	display: flex;
	gap: 4px;
}

.kpi-card__quick-buttons:hover {
	opacity: 1;
}

.kpi-card__quick-btn {
	transition: all 0.2s ease;
}

.kpi-card__quick-btn:hover {
	background: rgba(255,255,255,0.2) !important;
	transform: translateY(-1px);
}

.kpi-card__quick-btn.active {
	background: var(--active-color, rgba(255,255,255,0.3)) !important;
	box-shadow: 0 2px 4px rgba(0,0,0,0.2);
	color: var(--active-label-color, #ffffff) !important;
}

/* Button style variants */
.kpi-card__quick-btn--minimal:hover {
	background: rgba(255,255,255,0.1) !important;
}

.kpi-card__quick-btn--pill:hover {
	background: rgba(255,255,255,0.2) !important;
}

/* Dark mode styles */
.kpi-card--dark {
	background: #1a1a1a !important;
	color: #ffffff !important;
}

/* Glass morphism theme styles */
.kpi-card--glass {
	background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%) !important;
}

.kpi-card--glass .kpi-card__kpi-section,
.kpi-card--glass .kpi-card__trend-section {
	backdrop-filter: blur(10px);
	-webkit-backdrop-filter: blur(10px);
}

/* Clickable card styles - apply to entire card */
.kpi-card--clickable {
	transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.kpi-card--clickable:hover {
	transform: translateY(-2px);
	box-shadow: 0 12px 20px rgba(0,0,0,0.15) !important;
}

.kpi-card--clickable:active {
	transform: translateY(0);
}

/* Selected card indicator styles */
.kpi-card--selected {
	transition: all 0.3s ease;
}

/* Force selected indicator styles to override theme styles - use higher specificity */
/* Icon styles */
.kpi-card__icon {
	transition: transform 0.2s ease, opacity 0.2s ease;
	display: inline-flex;
	align-items: center;
	justify-content: center;
}

.kpi-card__icon:hover {
	transform: scale(1.1);
	opacity: 1 !important;
}

.kpi-card__icon > svg,
.kpi-card__icon > img,
.kpi-card__icon > span > svg,
.kpi-card__icon > span > img {
	width: var(--icon-size, 24px);
	height: var(--icon-size, 24px);
}

.kpi-card__icon svg {
	display: block;
}

.kpi-card__value-row {
	display: flex;
	align-items: center;
	justify-content: space-between;
	width: 100%;
	gap: 12px;
	font-size: inherit;
	line-height: 1.2;
}

.kpi-card__icon--value {
	display: inline-flex;
	margin-left: auto;
}

/* Status badge styles */
.kpi-card__status-badge {
	transition: transform 0.2s ease, opacity 0.2s ease;
	animation: pulse-badge 2s infinite;
	position: relative;
}

@keyframes pulse-badge {
	0%, 100% { opacity: 0.2; transform: scale(1); }
	50% { opacity: 0.4; transform: scale(1.05); }
}

.kpi-card__status-badge:hover {
	opacity: 0.6 !important;
	transform: scale(1.1);
}

/* Chrome container for quick buttons + badge */
.kpi-card__chrome {
	position: absolute;
	top: 8px;
	right: 8px;
	display: flex;
	align-items: center;
	gap: 8px;
	z-index: 10;
}

.kpi-card__chrome .kpi-card__quick-buttons {
	position: relative;
}

.kpi-card__chrome .kpi-card__status-badge {
	position: relative;
}

.kpi-card--dark .kpi-card__title {
	color: #e5e5e5 !important;
}

.kpi-card--dark .kpi-card__value {
	color: #ffffff !important;
}

.kpi-card--dark .kpi-card__labels {
	color: #a3a3a3 !important;
}

.kpi-card--dark .kpi-card__measure-label {
	color: #d4d4d4 !important;
}

.kpi-card--dark .kpi-card__delta {
	color: inherit !important;
}

.kpi-card--dark .kpi-card__quick-btn {
	background: rgba(255,255,255,0.1) !important;
	color: #ffffff !important;
	border-color: rgba(255,255,255,0.2) !important;
}

.kpi-card--dark .kpi-card__quick-btn:hover {
	background: rgba(255,255,255,0.2) !important;
}

.kpi-card--dark .kpi-card__quick-btn.active {
	background: var(--active-color, rgba(255,255,255,0.3)) !important;
	color: var(--active-label-color, #ffffff) !important;
}
